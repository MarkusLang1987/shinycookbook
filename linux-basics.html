<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Linux Basics | R Shiny Cookbook</title>
  <meta name="description" content="9 Linux Basics | R Shiny Cookbook" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Linux Basics | R Shiny Cookbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Linux Basics | R Shiny Cookbook" />
  
  
  

<meta name="author" content="Markus Lang" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="git.html">
<link rel="next" href="deploy-shiny-apps-on-your-own-website.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="preface.html"><a href="preface.html#what-this-book-will-cover"><i class="fa fa-check"></i><b>1.1</b> What this book will cover</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>2</b> Data Wrangling</a><ul>
<li class="chapter" data-level="2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>2.1</b> Data Wrangling with dplyr</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#nse-and-tidy-evaluation"><i class="fa fa-check"></i><b>2.1.1</b> NSE and Tidy evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interactive-data-visualisation.html"><a href="interactive-data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Interactive Data Visualisation</a><ul>
<li class="chapter" data-level="3.1" data-path="interactive-data-visualisation.html"><a href="interactive-data-visualisation.html#the-highcharter-package"><i class="fa fa-check"></i><b>3.1</b> The highcharter Package</a><ul>
<li class="chapter" data-level="3.1.1" data-path="interactive-data-visualisation.html"><a href="interactive-data-visualisation.html#barchart"><i class="fa fa-check"></i><b>3.1.1</b> Barchart</a></li>
<li class="chapter" data-level="3.1.2" data-path="interactive-data-visualisation.html"><a href="interactive-data-visualisation.html#scatterplot"><i class="fa fa-check"></i><b>3.1.2</b> Scatterplot</a></li>
<li class="chapter" data-level="3.1.3" data-path="interactive-data-visualisation.html"><a href="interactive-data-visualisation.html#linechart"><i class="fa fa-check"></i><b>3.1.3</b> Linechart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="html.html"><a href="html.html"><i class="fa fa-check"></i><b>4</b> HTML</a></li>
<li class="chapter" data-level="5" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>5</b> CSS</a></li>
<li class="chapter" data-level="6" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>6</b> Bootstrap</a></li>
<li class="chapter" data-level="7" data-path="javascript.html"><a href="javascript.html"><i class="fa fa-check"></i><b>7</b> JavaScript</a></li>
<li class="chapter" data-level="8" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>8</b> Git</a><ul>
<li class="chapter" data-level="8.1" data-path="git.html"><a href="git.html#git-is-a-version-control-system-that-allows-you-to-track-changes-with-time-points-and-to-work-on-the-same-project-with-different-people-regardless-of-location.-git-is-an-absolute-prerequisite-in-the-industry-and-is-being-adapted-more-and-more-in-the-field-of-data-science.-this-chapters-how-to-install-and-use-git."><i class="fa fa-check"></i><b>8.1</b> Git is a version control system that allows you to track changes with time points and to work on the same project with different people regardless of location. Git is an absolute prerequisite in the industry and is being adapted more and more in the field of data science. This chapters how to install and use git.</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linux-basics.html"><a href="linux-basics.html"><i class="fa fa-check"></i><b>9</b> Linux Basics</a><ul>
<li class="chapter" data-level="9.1" data-path="linux-basics.html"><a href="linux-basics.html#set-up-r-shiny-on-a-linux-ubuntu-18.04-vm"><i class="fa fa-check"></i><b>9.1</b> Set up R-Shiny on a Linux Ubuntu 18.04 VM</a></li>
<li class="chapter" data-level="9.2" data-path="linux-basics.html"><a href="linux-basics.html#installing-packages"><i class="fa fa-check"></i><b>9.2</b> Installing packages</a></li>
<li class="chapter" data-level="9.3" data-path="linux-basics.html"><a href="linux-basics.html#use-linux-to-automatically-send-reports"><i class="fa fa-check"></i><b>9.3</b> Use Linux to automatically send reports</a></li>
<li class="chapter" data-level="9.4" data-path="linux-basics.html"><a href="linux-basics.html#daily-reports-with-mails-gmail"><i class="fa fa-check"></i><b>9.4</b> Daily reports with mails (Gmail):</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deploy-shiny-apps-on-your-own-website.html"><a href="deploy-shiny-apps-on-your-own-website.html"><i class="fa fa-check"></i><b>10</b> Deploy Shiny apps on your own website</a></li>
<li class="chapter" data-level="11" data-path="deploy-shiny-apps-on-your-own-website-1.html"><a href="deploy-shiny-apps-on-your-own-website-1.html"><i class="fa fa-check"></i><b>11</b> Deploy Shiny apps on your own website</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Shiny Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linux-basics" class="section level1">
<h1><span class="header-section-number">9</span> Linux Basics</h1>
<p>To be able to offer R-Shiny dashboards to customers or use it for your own portfolio website without having the .shinyapps.io extension, it is worthwhile to buy your own domain and a web server (in 2019 a good investment for everyone in tech). Domains are available for 20 dollar per year, a webserver is available from 5 dollar per month. I personally use and recommend digitalocean because the server is very easy to use and a complete virtual machine can be set up within a few minutes.</p>
<div id="set-up-r-shiny-on-a-linux-ubuntu-18.04-vm" class="section level2">
<h2><span class="header-section-number">9.1</span> Set up R-Shiny on a Linux Ubuntu 18.04 VM</h2>
<p>First thing to do on your vm is to set up a non root-user.</p>
<pre class="console"><code>adduser markus
gpasswd -a markus sudo

su - markus</code></pre>
<p>Simple rule - never use root user to manipulate anything on your server. Always use a “superuser”.</p>
<p>Next Step is to install a webserver, where shiny apps can run. The two most popular are apache and nginx. Nginx seems to be better suited and better documented in combination with shiny.</p>
<pre class="console"><code>sudo apt-get update
sudo apt-get -y install nginx</code></pre>
<p>Nginx works as a service. The most often used commands are start, stop and restart which should be selfexplanatory. Before installing R, you have to add the KEY and Repository</p>
<pre class="console"><code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
sudo add-apt-repository &#39;deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/&#39;
sudo apt update</code></pre>
<p>Now install R</p>
<pre class="console"><code>sudo apt install r-base</code></pre>
<p>To see if everything worked fine, start R:</p>
<pre class="console"><code>sudo R</code></pre>
</div>
<div id="installing-packages" class="section level2">
<h2><span class="header-section-number">9.2</span> Installing packages</h2>
<p>I recommend to never install packages inside R, but always from the command line. Reason for this is that packages should be available to every user. When you install packages in R, they will be saved in the personal library and others users can not use them. So always install the packages with <code>console sudo su</code></p>
<p>Now install shiny with the following command:</p>
<pre class="console"><code>sudo su - -c &quot;R -e \&quot;install.packages(&#39;shiny, repos=&#39;http://cran.rstudio.com/&#39;)\&quot;&quot;</code></pre>
<p>Now get the latest version of shiny server:</p>
<pre class="console"><code>wget https://download3.rstudio.org/ubuntu-12.04/x86_64/shiny-server-1.5.6.875-amd64.deb
sudo gdebi shiny-server-1.5.6.875-amd64.deb</code></pre>
</div>
<div id="use-linux-to-automatically-send-reports" class="section level2">
<h2><span class="header-section-number">9.3</span> Use Linux to automatically send reports</h2>
<p>Linux can offer great opporunities to run scripts from a scheduler called cron that allows you to execute scripts at repeating points in time. This is great for pulling data from API´s and writing it to a database that will be accessed by an app the next day. Even things like server updates can be moved to times of day where they don’t get in touch with active users. Cron is preinstalled and can be accessed with:</p>
<pre class="console"><code>crontab -e</code></pre>
<p>Cron commands look liket his</p>
<pre class="console"><code>0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</code></pre>
<p>This websites helps you with the settings how often you want to call a cron job: <a href="https://crontab.guru/every-10-minutes" class="uri">https://crontab.guru/every-10-minutes</a></p>
<p>Some issues which caused me a headache when my scripts were not executed, but worked when i executed them from the command line: - Permission: You always have set the settings to allow the script being executed. The following command allows the current user to read, write and execute the file.</p>
<pre class="console"><code>sudo chmod 777 /path/script.R</code></pre>
<p>Another big issue was abouts paths: It seems to be a good solution to always use absolute paths if you want to run cron (point to the folder where your script lives).</p>
<pre class="console"><code># Bad
*/30 * * * * script.sh &gt; listener2.log 2&gt;&amp;1
# Good
*/30 * * * * /bin/sh /home/markus/Spielplatz/script.sh &gt; /tmp/listener2.log 2&gt;&amp;</code></pre>
<p>The problem with cron is that errors are silent, so check these two issues first if your script does not work as expected. There might be other problems of course, but I do not use cron so often to be familiar with all of then.</p>
</div>
<div id="daily-reports-with-mails-gmail" class="section level2">
<h2><span class="header-section-number">9.4</span> Daily reports with mails (Gmail):</h2>
<p>Sometimes it´s more suitable to send reports to your clients, may it be on a daily, weekly or monthly basis. To create a report, you need a markdown.Rmd file and a second file (script.R), whichs calls the second markdown file. Here is a basic example how this works, both codes worked fine in my example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">library</span>(rmarkdown)

<span class="kw">knit</span>(<span class="dt">input =</span> <span class="st">&quot;/home/user/stockreport.Rmd&quot;</span>) 
<span class="kw">render</span>(<span class="dt">input =</span> <span class="st">&quot;/home/user/stockreport.Rmd&quot;</span>, <span class="dt">output_format =</span> <span class="st">&quot;html_document&quot;</span>, <span class="dt">output_dir =</span> <span class="st">&quot;/home/user&quot;</span>)</code></pre></div>
<p>The R Markdown gets rendered and stored in the output_dir. If you want to send it automatically to somebody, you need a tool or library that can be used from cron. I tested tools inside the linux world like Sendmail and postfix, but I was not a able to get it work. Same applied for the sendMailR Package.</p>
<p>One important thing to do is to allow less secure apps get access to your mail account, which you can do here: <a href="https://myaccount.google.com/lesssecureapps" class="uri">https://myaccount.google.com/lesssecureapps</a></p>
<p>I managed to get this code working with the following python script:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python3</span>

<span class="im">import</span> smtplib
<span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText
<span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart
<span class="im">from</span> email.mime.base <span class="im">import</span> MIMEBase
<span class="im">from</span> email <span class="im">import</span> encoders

email_user <span class="op">=</span> <span class="st">&#39;youownmail@gmail.com&#39;</span>
email_password <span class="op">=</span> <span class="st">&#39;password&#39;</span>
email_send <span class="op">=</span> <span class="st">&#39;theothersmail.com&#39;</span>

subject <span class="op">=</span> <span class="st">&#39;yourreport&#39;</span>

msg <span class="op">=</span> MIMEMultipart()
msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> email_user
msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> email_send
msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> subject

body <span class="op">=</span> <span class="st">&#39;This is a Stockreport&#39;</span>
msg.attach(MIMEText(body,<span class="st">&#39;plain&#39;</span>))

filename<span class="op">=</span><span class="st">&#39;/home/user/stockreport.html&#39;</span>
attachment  <span class="op">=</span><span class="bu">open</span>(filename,<span class="st">&#39;rb&#39;</span>)

part <span class="op">=</span> MIMEBase(<span class="st">&#39;application&#39;</span>,<span class="st">&#39;octet-stream&#39;</span>)
part.set_payload((attachment).read())
encoders.encode_base64(part)
part.add_header(<span class="st">&#39;Content-Disposition&#39;</span>,<span class="st">&quot;attachment; filename= &quot;</span><span class="op">+</span> filename)

msg.attach(part)
text <span class="op">=</span> msg.as_string()
server <span class="op">=</span> smtplib.SMTP(<span class="st">&#39;smtp.gmail.com&#39;</span>,<span class="dv">587</span>)
server.starttls()
server.login(email_user,email_password)

server.sendmail(email_user,email_send,text)
server.quit()

<span class="bu">print</span>(<span class="st">&quot;script done&quot;</span>)</code></pre></div>
<p>Run this script from cron and y</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="git.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="deploy-shiny-apps-on-your-own-website.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
